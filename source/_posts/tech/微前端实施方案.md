---
title: å¾®å‰ç«¯å®æ–½æ–¹æ¡ˆ
date: '2023-01-31 15:56:00'
tags: []
categories:
  - æŠ€æœ¯
excerpt: >-
  ä»‹ç»å¾®å‰ç«¯å¾®å‰ç«¯çš„æ¦‚å¿µæ˜¯ç”± ThoughtWorks
  åœ¨2016å¹´æå‡ºçš„ï¼Œå®ƒå€Ÿé‰´äº†å¾®æœåŠ¡çš„æ¶æ„ç†å¿µï¼Œæ ¸å¿ƒåœ¨äºå°†ä¸€ä¸ªåºå¤§çš„å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çµæ´»çš„å°å‹åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹è¿è¡Œã€ç‹¬...
description: >-
  ä»‹ç»å¾®å‰ç«¯å¾®å‰ç«¯çš„æ¦‚å¿µæ˜¯ç”± ThoughtWorks
  åœ¨2016å¹´æå‡ºçš„ï¼Œå®ƒå€Ÿé‰´äº†å¾®æœåŠ¡çš„æ¶æ„ç†å¿µï¼Œæ ¸å¿ƒåœ¨äºå°†ä¸€ä¸ªåºå¤§çš„å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çµæ´»çš„å°å‹åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹è¿è¡Œã€ç‹¬......
keywords:
  - å¾®å‰ç«¯å®æ–½æ–¹æ¡ˆ
  - æŠ€æœ¯
cover: ''
---

ä»‹ç»å¾®å‰ç«¯å¾®å‰ç«¯çš„æ¦‚å¿µæ˜¯ç”± ThoughtWorks åœ¨2016å¹´æå‡ºçš„ï¼Œå®ƒå€Ÿé‰´äº†å¾®æœåŠ¡çš„æ¶æ„ç†å¿µï¼Œæ ¸å¿ƒåœ¨äºå°†ä¸€ä¸ªåºå¤§çš„å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çµæ´»çš„å°å‹åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹è¿è¡Œã€ç‹¬...
<!-- more -->
## ä»‹ç»

### å¾®å‰ç«¯

å¾®å‰ç«¯çš„æ¦‚å¿µæ˜¯ç”± ThoughtWorks åœ¨2016å¹´æå‡ºçš„ï¼Œå®ƒå€Ÿé‰´äº†å¾®æœåŠ¡çš„æ¶æ„ç†å¿µï¼Œæ ¸å¿ƒåœ¨äºå°†ä¸€ä¸ªåºå¤§çš„å‰ç«¯åº”ç”¨æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çµæ´»çš„å°å‹åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘ã€ç‹¬ç«‹è¿è¡Œã€ç‹¬ç«‹éƒ¨ç½²ï¼Œå†å°†è¿™äº›å°å‹åº”ç”¨èåˆä¸ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ï¼Œæˆ–è€…å°†åŸæœ¬è¿è¡Œå·²ä¹…ã€æ²¡æœ‰å…³è”çš„å‡ ä¸ªåº”ç”¨èåˆä¸ºä¸€ä¸ªåº”ç”¨ã€‚å¾®å‰ç«¯æ—¢å¯ä»¥å°†å¤šä¸ªé¡¹ç›®èåˆä¸ºä¸€ï¼Œåˆå¯ä»¥å‡å°‘é¡¹ç›®ä¹‹é—´çš„è€¦åˆï¼Œæå‡é¡¹ç›®æ‰©å±•æ€§ï¼Œç›¸æ¯”ä¸€æ•´å—çš„å‰ç«¯ä»“åº“ï¼Œå¾®å‰ç«¯æ¶æ„ä¸‹çš„å‰ç«¯ä»“åº“å€¾å‘äºæ›´å°æ›´çµæ´»ã€‚

å®ƒä¸»è¦è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š

*   1ã€éšç€é¡¹ç›®è¿­ä»£åº”ç”¨è¶Šæ¥è¶Šåºå¤§ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚
*   2ã€è·¨å›¢é˜Ÿæˆ–è·¨éƒ¨é—¨åä½œå¼€å‘é¡¹ç›®å¯¼è‡´æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚

![image.png](https://www.godlike.top/usr/uploads/2023/01/1884718512.png "image.png")

### å¼€æºæ¡†æ¶

å­—èŠ‚è·³åŠ¨: [Garfish](https://www.garfishjs.org/)

äº¬ä¸œ: [micro-app](https://zeroing.jd.com/micro-app/)

èš‚èšé‡‘æœ: [qiankun](https://qiankun.umijs.org/) (qiankunæ˜¯åŸºäº [single-spa](https://github.com/single-spa/single-spa) çš„ä¸€å±‚å°è£…)

## æ¯”è¾ƒ

### Garfish

ä¼˜åŠ¿

*   è‡ªå®ç°
*   æä¾›ç¼“å­˜
*   æ²™ç›’åŠŸèƒ½

åŠ£åŠ¿

*   éœ€è¦é…ç½®çš„é…ç½®é¡¹è¾ƒå¤š
*   åŸºåº§åº”ç”¨å¿…é¡»ä¸ºreact
*   æ‡’åŠ è½½ã€åˆ·æ–°æœ‰æ—¶æœ‰å¥‡æ€ªçš„é—®é¢˜
*   ä¸æ”¯æŒåµŒå¥—(å­åº”ç”¨ä¸èƒ½æ—¢æ˜¯ä¸»åˆæ˜¯å­)

### micro-app

ä¼˜åŠ¿

*   åŸºäºwebComponentæŠ€æœ¯
*   åµŒå…¥æ— éœ€æ–°å¢ä¾èµ–
*   åº”ç”¨æ— é™åˆ¶
*   æ²™ç›’åŠŸèƒ½
*   é¢„åŠ è½½

åŠ£åŠ¿

*   é™æ€èµ„æºæœ‰æ—¶ä¼šæœ‰é—®é¢˜
*   angularå­åº”ç”¨æ— æ³•ä½¿ç”¨æ‡’åŠ è½½
*   ä¸æ”¯æŒåµŒå¥—(å­åº”ç”¨ä¸èƒ½æ—¢æ˜¯ä¸»åˆæ˜¯å­)

> é‰´äºå®é™…ä¸Šæ‰‹éš¾åº¦ä»¥åŠä½¿ç”¨åœºæ™¯æˆ‘ä»¬å†³å®šåŸºäºmicro-appæ¥å®ç°æˆ‘ä»¬çš„å¾®å‰ç«¯æ–¹æ¡ˆ

## å®æ“

### ä¸»åº”ç”¨(é¢„ç®—planningé¡¹ç›®)

#### 1ã€å®‰è£…ä¾èµ–

```
npm i @micro-zoe/micro-app --save
```

#### 2ã€åœ¨å…¥å£å¤„å¼•å…¥

```
// index.js
import microApp from '@micro-zoe/micro-app'
microApp.start()

// å®é™…ä»£ç (main.js)

import { enableProdMode } from '@angular/core';
import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
import { AppModule } from './app/app.module';
import { environment } from './environments/environment';
// entry
import microApp from '@micro-zoe/micro-app'
microApp.start()
if (environment.production) {
 enableProdMode();
}
platformBrowserDynamic().bootstrapModule(AppModule)
 .catch((err) => console.error(err));
```

#### 3ã€å¢åŠ å¯¹WebComponentçš„æ”¯æŒ

åœ¨`app/app.module.ts`ä¸­æ·»åŠ `CUSTOM_ELEMENTS_SCHEMA`åˆ°`@NgModule.schemas`

```
// app/app.module.ts
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
@NgModule({
 schemas: [CUSTOM_ELEMENTS_SCHEMA],
})
```

#### 4ã€åˆ†é…è·¯ç”±ç»™å­åº”ç”¨

```
// app/app-routing.module.ts
import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { MyAngularComponent } from "./my-angular/my-angular.component";
import { MyReactComponent } from "./my-react/my-react.component";
import { MyVueComponent } from "./my-vue/my-vue.component";
const routes: Routes = [
 {
Â Â Â Â  // ğŸ‘‡ éä¸¥æ ¼åŒ¹é…ï¼Œ/examples/angular/* éƒ½æŒ‡å‘ my-angular é¡µé¢
 Â Â Â Â path: 'examples/angular',
 Â Â Â Â children: [{
 Â Â Â Â path: '**',
 Â Â Â Â component: MyAngular
 Â Â Â Â }]
 },
 {
 Â Â Â Â path: 'examples/react',
 Â Â Â Â children: [{
 Â Â Â Â path: '**',
 Â Â Â Â component: MyReactComponent
 Â Â Â Â }]
 },
 {
 Â Â Â Â path: 'examples/vue',
 Â Â Â Â children: [{
 Â Â Â Â path: '**',
 Â Â Â Â component: MyVueComponent
 Â Â Â Â }]
 },
];
@NgModule({
 imports: [RouterModule.forRoot(routes)],
 exports: [RouterModule],
})
export class AppRoutingModule { }
```

#### 5ã€åœ¨é¡µé¢ä¸­åµŒå…¥å­åº”ç”¨

<!-- app/my-angular/my-angular.component.html -->

```
<micro-app disableScopecss name='app-angular' url='http://localhost:3000/' baseroute='/examples/angular'></micro-app>

<!-- app/my-vue/my-vue.component.html -->

<micro-app disableScopecss name='app-vue' url='http://localhost:8080/' baseroute='/examples/vue'></micro-app>

<!-- app/my-react/my-react.component.html -->

<micro-app disableScopecss name='app-react' url='http://localhost:3001/' baseroute='/examples/react'></micro-app>
```

### å­åº”ç”¨

#### Angular

##### 1ã€å…³é—­çƒ­æ›´æ–°

```
"scripts": {
 "start": "ng serve --live-reload false",
},
```

##### 2ã€è®¾ç½®åŸºç¡€è·¯ç”±(å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥)

```
// app/app-routing.module.ts
import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { APP_BASE_HREF } from '@angular/common';
const routes: Routes = [...];

@NgModule({
 imports: [RouterModule.forRoot(routes)],
 exports: [RouterModule],
 // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±
 providers: [{
 provide: APP_BASE_HREF,
 Â Â Â Â // angularå­åº”ç”¨å®æµ‹éœ€è¦æ­¤ä¸­æ–¹å¼è·å–è·¯å¾„,å¯èƒ½æ˜¯æ–‡æ¡£æ›´æ–°ä¸é½å…¨
 Â Â Â Â // @ts-ignore __MICRO_APP_BASE_ROUTE__ ä¸ºmicro-appä¼ å…¥çš„åŸºç¡€è·¯ç”±
 Â Â Â Â useValue: (window["__MICRO_APP_PROXY_WINDOW__"] && window["__MICRO_APP_PROXY_WINDOW__"]["__MICRO_APP_BASE_ROUTE__"]) || '/',
 }]
})
export class AppRoutingModule { }
```

##### 3ã€è®¾ç½®publicPath

**æ­¥éª¤1:** åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹

```
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window["__MICRO_APP_PROXY_WINDOW__"] && window["__MICRO_APP_PROXY_WINDOW__"]["__MICRO_APP_ENVIRONMENT__"]) {
 // eslint-disable-next-line
 __webpack_public_path__ = window["__MICRO_APP_PROXY_WINDOW__"]["__MICRO_APP_PUBLIC_PATH__"]
}
```

**æ­¥éª¤2:** åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js

```
// entry
import './public-path'
```

##### 4ã€ç›‘å¬å¸è½½

å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚

```
// main.ts
let app = null;
platformBrowserDynamic()
 .bootstrapModule(AppModule)
 .then((res: NgModuleRef<AppModule>) => {
Â Â Â Â  app = res
 })
// ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () {
 app.destroy();
 app = null;
})
```

#### React

##### 1ã€è®¾ç½®åŸºç¡€è·¯ç”±(å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥)

```
// router.js
import { BrowserRouter, Switch, Route } from 'react-router-dom'
export default function AppRoute () {
 return (
 // ğŸ‘‡ è®¾ç½®åŸºç¡€è·¯ç”±ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®baserouteå±æ€§ï¼Œåˆ™window.__MICRO_APP_BASE_ROUTE__ä¸ºç©ºå­—ç¬¦ä¸²
 <BrowserRouter basename={window.__MICRO_APP_BASE_ROUTE__ || '/'}> ... </BrowserRouter>
 )
}
```

æˆ–è€…

```
// index.js
const router = createBrowserRouter([
 {
 path: '/',
 element: <App />
 }
],
 {
 // @ts-ignore
 basename: (window['__MICRO_APP_BASE_ROUTE__']) || '/'
 })
```

##### 2ã€è®¾ç½®publicPath

**æ­¥éª¤1:** åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹

```
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) {
 // eslint-disable-next-line
 __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
```

**æ­¥éª¤2:** åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js

```
// entry
import './public-path'
```

##### 3ã€ç›‘å¬å¸è½½

```
å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚

window.addEventListener('unmount', function () {
 root.unmount() // react 18
 // ReactDOM.unmountComponentAtNode(document.getElementById('root'))
})
```

#### Vue

##### 1ã€è®¾ç½®è·¨åŸŸæ”¯æŒ

```
åœ¨vue.config.jsä¸­æ·»åŠ é…ç½®

const { defineConfig } = require('@vue/cli-service')
module.exports = defineConfig({
 transpileDependencies: true,
 devServer: {
 headers: {
 'Access-Control-Allow-Origin': '*',
 }
 }
})
```

##### 2ã€è®¾ç½®åŸºç¡€è·¯ç”±(å¦‚æœåŸºåº§æ˜¯historyè·¯ç”±ï¼Œå­åº”ç”¨æ˜¯hashè·¯ç”±ï¼Œè¿™ä¸€æ­¥å¯ä»¥çœç•¥)

```
// main.js
import { createRouter, createWebHistory } from 'vue-router'
import routes from './router'
const router = createRouter({
 // ğŸ‘‡ __MICRO_APP_BASE_ROUTE__ ä¸ºmicro-appä¼ å…¥çš„åŸºç¡€è·¯ç”±
 history: createWebHistory(window.__MICRO_APP_BASE_ROUTE__ || process.env.BASE_URL),
 routes,
})
```

##### 3ã€è®¾ç½®publicPath

**æ­¥éª¤1:** åœ¨å­åº”ç”¨srcç›®å½•ä¸‹åˆ›å»ºåç§°ä¸ºpublic-path.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹

```
// __MICRO_APP_ENVIRONMENT__å’Œ__MICRO_APP_PUBLIC_PATH__æ˜¯ç”±micro-appæ³¨å…¥çš„å…¨å±€å˜é‡
if (window.__MICRO_APP_ENVIRONMENT__) {
 // eslint-disable-next-line
 __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__
}
```

**æ­¥éª¤2:** åœ¨å­åº”ç”¨å…¥å£æ–‡ä»¶çš„æœ€é¡¶éƒ¨å¼•å…¥public-path.js

```
// entry
import './public-path'
```

##### 4ã€ç›‘å¬å¸è½½

```
å­åº”ç”¨è¢«å¸è½½æ—¶ä¼šæ¥å—åˆ°ä¸€ä¸ªåä¸ºunmountçš„äº‹ä»¶ï¼Œåœ¨æ­¤å¯ä»¥è¿›è¡Œå¸è½½ç›¸å…³æ“ä½œã€‚

// main.js
const app = createApp(App)
app.mount('#app')
// ç›‘å¬å¸è½½æ“ä½œ
window.addEventListener('unmount', function () {
 app.unmount()
})
```

### æ•°æ®é€šä¿¡

#### ä¸€ã€å­åº”ç”¨è·å–æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®

micro-appä¼šå‘å­åº”ç”¨æ³¨å…¥åç§°ä¸ºmicroAppçš„å…¨å±€å¯¹è±¡ï¼Œå­åº”ç”¨é€šè¿‡è¿™ä¸ªå¯¹è±¡å’ŒåŸºåº§åº”ç”¨è¿›è¡Œæ•°æ®äº¤äº’ã€‚

æœ‰ä¸¤ç§æ–¹å¼è·å–æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®ï¼š

**æ–¹å¼1ï¼šç›´æ¥è·å–æ•°æ®**

```
const data = window.microApp.getData() // è¿”å›åŸºåº§ä¸‹å‘çš„dataæ•°æ®
```

**æ–¹å¼2ï¼šç»‘å®šç›‘å¬å‡½æ•°**

```
function dataListener (data) {
 console.log('æ¥è‡ªåŸºåº§åº”ç”¨çš„æ•°æ®', data)
}
/**

- ç»‘å®šç›‘å¬å‡½æ•°ï¼Œç›‘å¬å‡½æ•°åªæœ‰åœ¨æ•°æ®å˜åŒ–æ—¶æ‰ä¼šè§¦å‘
- dataListener: ç»‘å®šå‡½æ•°
- autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse
- !!!é‡è¦è¯´æ˜: å› ä¸ºå­åº”ç”¨æ˜¯å¼‚æ­¥æ¸²æŸ“çš„ï¼Œè€ŒåŸºåº§å‘é€æ•°æ®æ˜¯åŒæ­¥çš„ï¼Œ
- å¦‚æœåœ¨å­åº”ç”¨æ¸²æŸ“ç»“æŸå‰åŸºåº§åº”ç”¨å‘é€æ•°æ®ï¼Œåˆ™åœ¨ç»‘å®šç›‘å¬å‡½æ•°å‰æ•°æ®å·²ç»å‘é€ï¼Œåœ¨åˆå§‹åŒ–åä¸ä¼šè§¦å‘ç»‘å®šå‡½æ•°ï¼Œ
- ä½†è¿™ä¸ªæ•°æ®ä¼šæ”¾å…¥ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶å¯ä»¥è®¾ç½®autoTriggerä¸ºtrueä¸»åŠ¨è§¦å‘ä¸€æ¬¡ç›‘å¬å‡½æ•°æ¥è·å–æ•°æ®ã€‚
  */
  window.microApp.addDataListener(dataListener: Function, autoTrigger?: boolean)
  // è§£ç»‘ç›‘å¬å‡½æ•°
  window.microApp.removeDataListener(dataListener: Function)
  // æ¸…ç©ºå½“å‰å­åº”ç”¨çš„æ‰€æœ‰ç»‘å®šå‡½æ•°(å…¨å±€æ•°æ®å‡½æ•°é™¤å¤–)
  window.microApp.clearDataListener()
```

#### äºŒã€å­åº”ç”¨å‘åŸºåº§åº”ç”¨å‘é€æ•°æ®

```
// dispatchåªæ¥å—å¯¹è±¡ä½œä¸ºå‚æ•°
window.microApp.dispatch({type: 'å­åº”ç”¨å‘é€çš„æ•°æ®'})
```

#### ä¸‰ã€åŸºåº§åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®

åŸºåº§åº”ç”¨å‘å­åº”ç”¨å‘é€æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼š

##### æ–¹å¼1: é€šè¿‡dataå±æ€§å‘é€æ•°æ®

###### Vue(Angularç±»ä¼¼)

```
<template>
  <micro-app
    name='my-app'
    url='xx'
    :data='dataForChild' // dataåªæ¥å—å¯¹è±¡ç±»å‹ï¼Œæ•°æ®å˜åŒ–æ—¶ä¼šé‡æ–°å‘é€
  />
</template>
<script>
export default {
  data () {
    return {
      dataForChild: {type: 'å‘é€ç»™å­åº”ç”¨çš„æ•°æ®'}
    }
  }
}
</script>
```

###### React

åœ¨Reactä¸­æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚

åœ¨<micro-app>å…ƒç´ æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfill(æ³¨é‡Šä¹Ÿè¦å¤åˆ¶)ã€‚

```
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
```

**å¼€å§‹ä½¿ç”¨**

```
<micro-app
 name='my-app'
 url='xx'
 data={this.state.dataForChild} // dataåªæ¥å—å¯¹è±¡ç±»å‹ï¼Œé‡‡ç”¨ä¸¥æ ¼å¯¹æ¯”(===)ï¼Œå½“ä¼ å…¥æ–°çš„dataå¯¹è±¡æ—¶ä¼šé‡æ–°å‘é€
/>
```

##### æ–¹å¼2: æ‰‹åŠ¨å‘é€æ•°æ®

æ‰‹åŠ¨å‘é€æ•°æ®éœ€è¦é€šè¿‡nameæŒ‡å®šæ¥å—æ•°æ®çš„å­åº”ç”¨ï¼Œæ­¤å€¼å’Œ<micro-app>å…ƒç´ ä¸­çš„nameä¸€è‡´ã€‚

```
import microApp from '@micro-zoe/micro-app'
// å‘é€æ•°æ®ç»™å­åº”ç”¨ my-appï¼ŒsetDataç¬¬äºŒä¸ªå‚æ•°åªæ¥å—å¯¹è±¡ç±»å‹
microApp.setData('my-app', {type: 'æ–°çš„æ•°æ®'})
```

#### å››ã€åŸºåº§åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®

åŸºåº§åº”ç”¨è·å–æ¥è‡ªå­åº”ç”¨çš„æ•°æ®æœ‰ä¸‰ç§æ–¹å¼ï¼š

##### æ–¹å¼1ï¼šç›´æ¥è·å–æ•°æ®

```
import microApp from '@micro-zoe/micro-app'
const childData = microApp.getData(appName) // è¿”å›å­åº”ç”¨çš„dataæ•°æ®
```

##### æ–¹å¼2: ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶ (datachange)

###### Vue(AngularåŒç†)

```
<template>
  <micro-app
    name='my-app'
    url='xx'
    // æ•°æ®åœ¨äº‹ä»¶å¯¹è±¡çš„detail.dataå­—æ®µä¸­ï¼Œå­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange
    @datachange='handleDataChange'
  />
</template>
<script>
export default {
  methods: {
    handleDataChange (e) {
      console.log('æ¥è‡ªå­åº”ç”¨çš„æ•°æ®ï¼š', e.detail.data)
    }
  }
}
</script>
```

###### React

åœ¨Reactä¸­æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªpolyfillã€‚

åœ¨<micro-app>å…ƒç´ æ‰€åœ¨çš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ polyfill(æ³¨é‡Šä¹Ÿè¦å¤åˆ¶)ã€‚

```
/** @jsxRuntime classic */
/** @jsx jsxCustomEvent */
import jsxCustomEvent from '@micro-zoe/micro-app/polyfill/jsx-custom-event'
```

**å¼€å§‹ä½¿ç”¨**

```
<micro-app
 name='my-app'
 url='xx'
 // æ•°æ®åœ¨event.detail.dataå­—æ®µä¸­ï¼Œå­åº”ç”¨æ¯æ¬¡å‘é€æ•°æ®éƒ½ä¼šè§¦å‘datachange
 onDataChange={(e) => console.log('æ¥è‡ªå­åº”ç”¨çš„æ•°æ®ï¼š', e.detail.data)}
/>
```

##### æ–¹å¼3: ç»‘å®šç›‘å¬å‡½æ•°

```
ç»‘å®šç›‘å¬å‡½æ•°éœ€è¦é€šè¿‡nameæŒ‡å®šå­åº”ç”¨ï¼Œæ­¤å€¼å’Œ<micro-app>å…ƒç´ ä¸­çš„nameä¸€è‡´ã€‚

import microApp from '@micro-zoe/micro-app'
function dataListener (data) {
 console.log('æ¥è‡ªå­åº”ç”¨my-appçš„æ•°æ®', data)
}
/**

- ç»‘å®šç›‘å¬å‡½æ•°
- appName: åº”ç”¨åç§°
- dataListener: ç»‘å®šå‡½æ•°
- autoTrigger: åœ¨åˆæ¬¡ç»‘å®šç›‘å¬å‡½æ•°æ—¶å¦‚æœæœ‰ç¼“å­˜æ•°æ®ï¼Œæ˜¯å¦éœ€è¦ä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼Œé»˜è®¤ä¸ºfalse
  */
  microApp.addDataListener(appName: string, dataListener: Function, autoTrigger?: boolean)
  // è§£ç»‘ç›‘å¬my-appå­åº”ç”¨çš„å‡½æ•°
  microApp.removeDataListener(appName: string, dataListener: Function)
  // æ¸…ç©ºæ‰€æœ‰ç›‘å¬appNameå­åº”ç”¨çš„å‡½æ•°
  microApp.clearDataListener(appName: string)
```

## DEMO

> ä¾èµ–ç‰ˆæœ¬: "@micro-zoe/micro-app": "^0.8.10"

> å†…éƒ¨é¡¹ç›®å°±ä¸å±•ç¤ºäº†

Angularä¸»åº”ç”¨(é¢„ç®—)

Reactå­åº”ç”¨

Vueå­åº”ç”¨

Angularå­åº”ç”¨
